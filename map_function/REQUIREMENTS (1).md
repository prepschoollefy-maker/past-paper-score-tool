# JukenMap — 首都圏 中学受験 学校検索マップ

## 1. プロジェクト概要

首都圏（東京・神奈川・埼玉・千葉＋茨城・栃木・群馬）の中学受験対象校を、Google Maps上で検索・比較できるWebツール。

保護者が「自宅から通える範囲で、条件に合う学校」を直感的に探せることがゴール。

| 項目 | 内容 |
|------|------|
| ターゲット | 中学受験を検討中の保護者 |
| 収益モデル | 無料公開（将来的にアフィリエイト・広告を検討可） |
| 技術スタック | Next.js / TypeScript / Google Maps API / Supabase / Vercel |

> 技術選定は推奨であり、同等の構成であれば変更可。

---

## 2. データ

学校マスタCSV（`jukenmap_schools_final.csv`）を提供済み。322校分。

### 2.1 提供済みカラム

| カラム | 型 | 備考 |
|--------|------|------|
| study_id | string | スタディ独自ID（B13P015等） |
| mext_code | string | 文科省学校コード |
| school_name | string | 学校名 |
| yotsuya_deviation_value | integer | 四谷大塚80偏差値（30〜73） |
| establishment | string | 私立 / 国立 / 公立中高一貫 |
| school_type | string | 男子校 / 女子校 / 共学校 |
| area | string | 東京23区 / 東京23区外 / 神奈川県 等 |
| prefecture | string | 都道府県名 |
| address | string | 住所（文科省データ） |
| postal_code | string | 郵便番号 |
| study_url | string | 中学受験スタディの学校ページURL |

### 2.2 要補完カラム

以下は開発時に補完が必要。方法は任せる。

| カラム | 補完のヒント |
|--------|-------------|
| latitude / longitude | 住所からGeocoding。国土地理院API（無料・無制限）が有力 |
| nearest_station | Google Places API or スタディ個別ページ |
| school_url | スタディ個別ページ or 検索 |

> カラム追加や構造変更は自由。上記は最低限のガイドライン。

---

## 3. MVP（最初のリリース）

まず動くものを作る。

### 3.1 地図表示

- Google Maps上に全校をピン表示
- 設置区分や偏差値帯でピンの色・アイコンを分けると見やすい
- ピンクリック/タップで学校の基本情報をポップアップまたはサイドパネルで表示
- 学校HPやスタディページへのリンクも含める

### 3.2 フィルタ検索

以下の条件で学校を絞り込める機能。UI設計は任せる。

| フィルタ | 内容 | 備考 |
|---------|------|------|
| 設置区分 | 私立 / 国立 / 公立中高一貫 | 複数選択 |
| 校種 | 男子校 / 女子校 / 共学校 | 複数選択 |
| 偏差値帯 | 最小〜最大のレンジ指定 | スライダー等 |
| エリア | 都道府県または詳細エリア | |
| 通学時間 | 出発地点から○分以内 | 後述 |

### 3.3 通学時間フィルタ

ユーザーが出発地点を入力し、「○分以内」で絞り込む機能。

コスト最適化が重要。Google Directions APIは1リクエスト0.5〜1円程度かかるため、全322校に毎回リクエストを飛ばすと高額になる。直線距離で事前フィルタしてからAPI呼び出しを行う、結果をキャッシュする等、工夫すること。

> 距離ベースの近似で割り切るか、限定的にAPIを使うか、判断は任せる。

### 3.4 お気に入り

気になる学校をお気に入り登録して一覧表示できる機能。localStorageで十分。

---

## 4. Phase 2（将来拡張）

MVPの次に検討する機能。MVP完成後に着手。優先度や実装方法は要相談。

| 機能 | 概要 |
|------|------|
| 入試日程フィルタ | 試験日・科目数でのフィルタ。データ収集が課題 |
| 学校比較 | 2〜3校を並べて偏差値・費用等を比較 |
| 併願シミュレーター | 入試日程の重複チェック＋併願パターン提案 |
| 偏差値推移 | 過去数年の偏差値変動をグラフ表示 |
| 口コミ・レビュー | ユーザー投稿の学校評価（要認証） |

---

## 5. Google Maps API コスト目安

Googleは毎月$200分の無料クレジットを提供。

| API | 単価 | 想定月間 | 月額概算 |
|-----|------|---------|---------|
| Maps JavaScript API | $7/1000回 | 5,000回 | $35 |
| Geocoding API | $5/1000回 | 初回のみ | $1.6 |
| Directions API | $5〜10/1000回 | 2,000回 | $10〜20 |
| Places API | $17〜32/1000回 | 500回 | $8〜16 |

合計$55〜72/月程度。$200無料枠内に十分収まる想定。

> 通学時間計算の設計次第でDirections APIのコストは大きく変動する。ここが最大のコスト最適化ポイント。

---

## 6. 非機能要件

| 項目 | 内容 |
|------|------|
| レスポンシブ | スマホでの利用を最優先。PC表示も対応 |
| パフォーマンス | 初期表示3秒以内（地図+ピン描画）を目標 |
| SEO | 学校一覧ページはSSR/SSGで検索エンジンにインデックスされるようにする |
| アクセシビリティ | 基本的なWCAGガイドラインに配慮 |
| ホスティング | Vercel推奨。月額無料〜低コスト |

---

## 7. 開発方針

**この文書はゴールと制約を定義するものであり、実装の細部を規定するものではない。**

| 原則 | 内容 |
|------|------|
| 動くものを優先 | 完璧を目指さず、まず動作するMVPを完成させる。リファクタリングは後からでいい |
| コスト意識 | Google Maps APIの課金を最小限に抑える工夫をすること。特にDirections APIの呼び出し頻度 |
| 判断は任せる | UI設計、コンポーネント分割、状態管理、ディレクトリ構成等は開発者が最適と思う形でよい |
| 相談してほしい点 | DBスキーマの大幅変更、外部API（Google以外）の導入、有料サービスの利用時 |

### 提供ファイル

- `jukenmap_schools_final.csv` — 322校の学校マスタ（住所入り）
